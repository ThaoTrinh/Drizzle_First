# Sample React + Redux + Saga + Drizzle App

## Smart contract

Development of smart contract is done through truffle, smart contracts are in `./contracts`, and migration scripts to deploy in `./migrations`.

```bash
truffle compile
truffle migrate --network <network name>
```

Prepare a file `.secret` contains the key of wallet. Change the url in `truffle-config.js`,
```js
new HDWalletProvider(
  mnemonic,
  infura_link
),
```

## React


### Redux and Store

Store is generated with Drizzle using `generateStore`.

### Drizzle

Drizzle is now using Context API, which means it only works on React v16.3 and above, for React < 16.3 click [here](https://github.com/trufflesuite/drizzle-react#using-the-legacy-api-for-react--v163). React Context API is a global state, called `context`, but accessible through component, to use the state, do:

```jsx
<Provider>
  <App />
</Provider>

// anywhere else in App

export default ComponentA extends React.Component {
  render() {
    return (
      <Consumer>
      {(consumer state) => {
        return <div></div>
      }}
      </Consumer>
    )
  }
}
```

Drizzle is the same, its context is
```js
const drizzleContext = {
  drizzle,       // this is the drizzle instance (use this to call `cacheCall` and `cacheSend`)
  drizzleState,  // this is the entire Drizzle state, it will always be up-to-date
  initialized    // this boolean value will indicate when Drizzle is ready
}
```

Accessing contracts by `drizzle.contracts` and call by their methods, example for a smart contract name: `Hello`:

```js
const Hello = drizzle.contracts.Hello;
Hello.methods.<name_of_method>(params).call() //  create a simple call
Hello.methods.<name_of_method>(params).send({
  from: 0xabcd, // account,
  value: 1000, // in wei
}) //  create a call that is payable

// we can cache call values
const dataKey = Hello.methods["storedData"].cacheCall();    /// don't known
this.setState({ dataKey });
```

## This app

This app store is generated by Drizzle, so it also has some drizzle variable in store, which can be access by `connect`. And the main drizzle variable, as context from `DrizzleContext.Provider`.
